module.exports=[50701,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95445),f=a.i(15618),g=a.i(10448),h=a.i(81560),i=a.i(87532),j=a.i(33350);let k=(0,a.i(70106).default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var l=a.i(210),m=a.i(21979);function n(){let a=(0,d.useRouter)(),n=(0,e.createClient)(),{language:o}=(0,m.useLanguage)(),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)("all"),[z,A]=(0,c.useState)("all"),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)({name:"",description:"",price:"",category:"",category_id:null,stock:"",image_url:"",available:!0}),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(null);async function T(){q(!0);try{let{data:{user:b}}=await n.auth.getUser();if(!b)return void a.push("/login");let c=localStorage.getItem("selected_restaurant_id");if(!c)return void a.push("/dashboard");let{data:d}=await n.from("restaurants").select("*").eq("id",c).eq("owner_id",b.id).single();if(!d)return;I(d);let e=await U(d.id),{data:f}=await n.from("menu_items").select("*").eq("restaurant_id",d.id).order("name");if(f){let a=f.map(a=>{if(a.category_id){let b=e.find(b=>b.id===a.category_id);if(b){let c=b.parent_id?e.find(a=>a.id===b.parent_id):null;return{...a,menu_category:{...b,parent:c||void 0}}}}return a});s(a)}}catch(a){console.error("Error loading menu:",a)}finally{q(!1)}}async function U(a){try{let{data:b,error:c}=await n.from("menu_categories").select("*").eq("restaurant_id",a).order("name");if(c)return console.error("Error fetching categories:",c),K([]),M([]),[];let d=b||[];K(d);let e=d.filter(a=>!a.parent_id);return M(e),d}catch(a){return console.error("Error fetching categories:",a),K([]),M([]),[]}}function V(a){return J.filter(b=>b.parent_id===a)}function W(a=null){a?(G(a),O({name:a.name||"",description:a.description||"",price:a.price?.toString()||"",category:a.category||"",category_id:a.category_id||null,stock:a.stock?.toString()||"",image_url:a.image_url||"",available:a.available??!0})):(G(null),O({name:"",description:"",price:"",category:"",category_id:null,stock:"",image_url:"",available:!0})),C(!0)}async function X(a){if(a.preventDefault(),!H)return;let b=N.category;if(N.category_id){let a=J.find(a=>a.id===N.category_id);a&&(b=a.parent_id?`${a.name} (${J.find(b=>b.id===a.parent_id)?.name})`:a.name)}let c={name:N.name,description:N.description,price:parseFloat(N.price),category:b,category_id:N.category_id,stock:parseInt(N.stock)||0,image_url:N.image_url,available:N.available,restaurant_id:H.id};try{F?await n.from("menu_items").update(c).eq("id",F.id):await n.from("menu_items").insert(c),C(!1),T()}catch(a){console.error("Error saving menu item:",a)}}async function Y(a){if(a.preventDefault(),H&&P.trim())try{let{error:a}=await n.from("menu_categories").insert({name:P.trim(),parent_id:R,restaurant_id:H.id});if(a)throw a;E(!1),Q(""),S(null),await U(H.id)}catch(a){console.error("Error creating category:",a),alert("en"===o?"Failed to create category":"Gagal membuat kategori")}}async function Z(a){if(confirm("en"===o?"Delete this item from menu?":"Hapus item ini dari menu?"))try{await n.from("menu_items").delete().eq("id",a),T()}catch(a){console.error("Error deleting item:",a)}}return(0,c.useEffect)(()=>{T()},[]),(0,c.useEffect)(()=>{let a;a=r,"all"!==x&&(a="uncategorized"===x?a.filter(a=>!a.category_id):a.filter(a=>!!a.menu_category&&(a.menu_category.id===x||a.menu_category.parent_id===x))),"all"!==z&&(a=a.filter(a=>a.category_id===z)),v&&(a=a.filter(a=>a.name?.toLowerCase().includes(v.toLowerCase())||a.description?.toLowerCase().includes(v.toLowerCase()))),u(a)},[v,x,z,r]),p?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-accent)]"})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>a.push("/dashboard/menu"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:(0,b.jsx)(l.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"en"===o?"Manage Menu":"Kelola Menu"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"en"===o?"Manage menu items, categories, and stock":"Atur menu, kategori, dan stok item"})]})]}),(0,b.jsxs)("button",{onClick:()=>W(),className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-accent)] text-white rounded-lg font-medium hover:bg-[var(--color-accent-hover)] transition-colors",children:[(0,b.jsx)(f.Plus,{className:"w-5 h-5"}),"en"===o?"Add Item":"Tambah Item"]})]})})}),(0,b.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-4 mb-6 border border-gray-100 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"en"===o?"Search menu...":"Cari menu...",value:v,onChange:a=>w(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors whitespace-nowrap",children:[(0,b.jsx)(j.Tag,{className:"w-4 h-4"}),"en"===o?"Manage Categories":"Kelola Kategori"]})})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[(0,b.jsxs)("select",{value:x,onChange:a=>{y(a.target.value),A("all")},className:"px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,b.jsx)("option",{value:"all",children:"en"===o?"All Categories":"Semua Kategori"}),L.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id)),(0,b.jsx)("option",{value:"uncategorized",children:"en"===o?"Uncategorized":"Tanpa Kategori"})]}),"all"!==x&&"uncategorized"!==x&&(0,b.jsxs)("select",{value:z,onChange:a=>A(a.target.value),className:"px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,b.jsx)("option",{value:"all",children:"en"===o?"All Subcategories":"Semua Subkategori"}),V(x).map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===t.length?(0,b.jsx)("div",{className:"col-span-full bg-white rounded-2xl p-12 text-center border border-gray-100",children:(0,b.jsx)("p",{className:"text-gray-500 text-lg",children:"en"===o?"No items found":"Tidak ada item ditemukan"})}):t.map(a=>{var c;let d;return(0,b.jsxs)("div",{className:"bg-white rounded-2xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:[(0,b.jsx)("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:a.image_url?(0,b.jsx)("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover"}):(0,b.jsx)("span",{className:"text-gray-400 text-4xl",children:"ðŸ½ï¸"})}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-1",children:a.name}),a.menu_category?(0,b.jsx)("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:(c=a.menu_category)?c.parent?`${c.name} (${c.parent.name})`:c.name:""}):(0,b.jsx)("span",{className:"inline-block px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:a.category||("en"===o?"Uncategorized":"Tanpa Kategori")})]})}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:a.description||("en"===o?"No description":"Tidak ada deskripsi")}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(d=a.price,new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d))}),void 0!==a.stock&&(0,b.jsxs)("span",{className:`text-sm font-medium ${a.stock>10?"text-green-600":a.stock>0?"text-yellow-600":"text-red-600"}`,children:["en"===o?"Stock":"Stok",": ",a.stock]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{onClick:()=>W(a),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[(0,b.jsx)(g.Edit2,{className:"w-4 h-4"}),"Edit"]}),(0,b.jsx)("button",{onClick:()=>Z(a.id),className:"px-4 py-2 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors",children:(0,b.jsx)(h.Trash2,{className:"w-4 h-4"})})]})]})]},a.id)})})]}),B&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6",children:F?"Edit Item":"en"===o?"Add Item":"Tambah Item"}),(0,b.jsxs)("form",{onSubmit:X,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Item Name":"Nama Item"}),(0,b.jsx)("input",{type:"text",required:!0,value:N.name,onChange:a=>O({...N,name:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Description":"Deskripsi"}),(0,b.jsx)("textarea",{value:N.description,onChange:a=>O({...N,description:a.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Price":"Harga"}),(0,b.jsx)("input",{type:"number",required:!0,value:N.price,onChange:a=>O({...N,price:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Category":"Kategori"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("select",{value:N.category_id||"",onChange:a=>O({...N,category_id:a.target.value||null}),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,b.jsx)("option",{value:"",children:"en"===o?"Select Category":"Pilih Kategori"}),L.map(a=>(0,b.jsxs)("optgroup",{label:a.name,children:[(0,b.jsx)("option",{value:a.id,children:a.name}),V(a.id).map(a=>(0,b.jsxs)("option",{value:a.id,children:["Â Â â†’ ",a.name]},a.id))]},a.id))]}),(0,b.jsxs)("button",{type:"button",onClick:()=>E(!0),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:["+ ","en"===o?"Create New Category":"Buat Kategori Baru"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Stock":"Stok"}),(0,b.jsx)("input",{type:"number",required:!0,value:N.stock,onChange:a=>O({...N,stock:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Image URL":"URL Gambar"}),(0,b.jsx)("input",{type:"url",value:N.image_url,onChange:a=>O({...N,image_url:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>C(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"en"===o?"Cancel":"Batal"}),(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-[var(--color-accent)] text-white rounded-lg font-medium hover:bg-[var(--color-accent-hover)] transition-colors",children:F?"en"===o?"Save":"Simpan":"en"===o?"Add":"Tambah"})]})]})]})}),D&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"en"===o?"Manage Categories":"Kelola Kategori"}),(0,b.jsxs)("form",{onSubmit:Y,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:"en"===o?"Create New Category":"Buat Kategori Baru"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Category Name":"Nama Kategori"}),(0,b.jsx)("input",{type:"text",value:P,onChange:a=>Q(a.target.value),placeholder:"en"===o?"e.g., Main Course, Dessert":"Contoh: Nasi Goreng, Main Course, Dessert",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===o?"Parent Category (Optional)":"Parent Kategori (Opsional)"}),(0,b.jsxs)("select",{value:R||"",onChange:a=>S(a.target.value||null),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,b.jsx)("option",{value:"",children:"en"===o?"No parent (Main Category)":"Tidak ada parent (Kategori Utama)"}),L.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)("button",{type:"submit",className:"w-full px-4 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors",children:"en"===o?"Add Category":"Tambah Kategori"})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"en"===o?"Existing Categories":"Kategori yang Ada"}),0===L.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-4",children:"en"===o?"No categories yet":"Belum ada kategori"}):(0,b.jsx)("div",{className:"space-y-3",children:L.map(a=>(0,b.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(k,{className:"w-5 h-5 text-gray-600"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:a.name}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["(",r.filter(b=>b.category_id===a.id||b.menu_category?.parent_id===a.id).length," ","items",")"]})]}),V(a.id).length>0&&(0,b.jsx)("div",{className:"ml-7 mt-2 space-y-1",children:V(a.id).map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,b.jsx)(j.Tag,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{children:a.name}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["(",r.filter(b=>b.category_id===a.id).length," ","items",")"]})]},a.id))})]},a.id))})]}),(0,b.jsx)("div",{className:"flex gap-2 pt-6 mt-6 border-t",children:(0,b.jsx)("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"en"===o?"Close":"Tutup"})})]})})]})}a.s(["default",()=>n],50701)}];

//# sourceMappingURL=src_app_dashboard_menu_manage_page_tsx_d94a8dc7._.js.map