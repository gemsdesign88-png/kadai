(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9694,e=>{"use strict";var a=e.i(71645),t=e.i(25949),r=e.i(33369),s=["axis","item"],l=(0,a.forwardRef)((e,l)=>a.createElement(r.CartesianChart,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:s,tooltipPayloadSearcher:t.arrayTooltipSearcher,categoricalChartProps:e,ref:l}));e.s(["BarChart",()=>l])},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},43432,e=>{"use strict";let a=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>a],43432)},84614,e=>{"use strict";let a=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>a],84614)},7233,e=>{"use strict";let a=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],7233)},92930,e=>{"use strict";let a=(0,e.i(75254).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>a],92930)},27612,e=>{"use strict";let a=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],27612)},85511,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(18566),s=e.i(11795),l=e.i(44674),n=e.i(7233),o=e.i(92930),i=e.i(27612),d=e.i(55436),c=e.i(84614),u=e.i(43432),m=e.i(17923),x=e.i(25652),f=e.i(9694),h=e.i(75225),g=e.i(85183),p=e.i(93230),b=e.i(72526),y=e.i(34239),v=e.i(31195),j=e.i(59559);function N(){let e=(0,r.useRouter)(),N=(0,s.createClient)(),{language:w}=(0,l.useLanguage)(),[k,S]=(0,t.useState)(!0),[C,T]=(0,t.useState)([]),[P,E]=(0,t.useState)([]),[_,R]=(0,t.useState)(""),[D,M]=(0,t.useState)("all"),[A,B]=(0,t.useState)(!1),[q,L]=(0,t.useState)(null),[I,K]=(0,t.useState)(null),[U,F]=(0,t.useState)([]),[H,z]=(0,t.useState)([]),[O,$]=(0,t.useState)("week"),[V,G]=(0,t.useState)({name:"",phone:"",role:"",pin:""});async function J(){try{let e=localStorage.getItem("selected_restaurant_id");if(!e)return;let{data:a}=await N.from("staff").select("role").eq("restaurant_id",e);if(a){let e=[...new Set(a.map(e=>e.role).filter(Boolean))];F(e.map(e=>({value:e,label:e})))}}catch(e){console.error("Error loading roles:",e)}}async function X(){try{let e=localStorage.getItem("selected_restaurant_id");if(!e)return;let a=new Date,t=new Date;"week"===O?t.setDate(a.getDate()-7):t.setDate(a.getDate()-30);let{data:r}=await N.from("orders").select("staff_id, total, status").eq("restaurant_id",e).gte("created_at",t.toISOString()).neq("status","cancelled");if(!r||0===r.length)return void z([]);let s=new Map;r.forEach(e=>{if(e.staff_id){let a=s.get(e.staff_id)||{revenue:0,orders:0};s.set(e.staff_id,{revenue:a.revenue+(e.total||0),orders:a.orders+1})}});let l=Array.from(s.keys()),{data:n}=await N.from("staff").select("id, name").in("id",l),o=l.map(e=>{let a=s.get(e),t=n?.find(a=>a.id===e);return{name:t?.name||"Unknown",revenue:a.revenue,orders:a.orders,avgOrder:a.orders>0?a.revenue/a.orders:0}}).sort((e,a)=>a.revenue-e.revenue);z(o)}catch(e){console.error("Error loading staff performance:",e),z([])}}async function Y(){S(!0);try{let{data:{user:a}}=await N.auth.getUser();if(!a)return void e.push("/login");let t=localStorage.getItem("selected_restaurant_id");if(console.log("Selected restaurant ID:",t),!t)return void e.push("/dashboard");let{data:r,error:s}=await N.from("restaurants").select("*").eq("id",t).eq("owner_id",a.id).single();if(console.log("Restaurant:",r,"Error:",s),!r)return;K(r);let{data:l,error:n}=await N.from("staff").select("*").eq("restaurant_id",r.id).order("name");console.log("Staff data:",l,"Error:",n),console.log("Staff count:",l?.length),l?T(l):T([])}catch(e){console.error("Error loading staff:",e),T([])}finally{S(!1)}}function Q(e=null){e?(L(e),G({name:e.name||"",phone:e.phone||"",role:e.role||"",pin:""})):(L(null),G({name:"",phone:"",role:"",pin:""})),B(!0)}async function W(e){if(e.preventDefault(),!I)return;let a={name:V.name,phone:V.phone,role:V.role,restaurant_id:I.id,...V.pin&&{pin:V.pin}};try{q?await N.from("staff").update(a).eq("id",q.id):await N.from("staff").insert(a),B(!1),Y(),J()}catch(e){console.error("Error saving staff:",e)}}async function Z(e){if(confirm("Hapus staff ini?"))try{await N.from("staff").delete().eq("id",e),Y()}catch(e){console.error("Error deleting staff:",e)}}return(0,t.useEffect)(()=>{Y(),J(),X()},[]),(0,t.useEffect)(()=>{X()},[O]),(0,t.useEffect)(()=>{let e;e=C,"all"!==D&&(e=e.filter(e=>e.role===D)),_&&(e=e.filter(e=>e.name?.toLowerCase().includes(_.toLowerCase()))),E(e)},[_,D,C]),k?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-accent)]"})}):(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"en"===w?"Manage Staff":"Kelola Staff"}),(0,a.jsx)("p",{className:"text-gray-600",children:"en"===w?"Manage staff accounts and roles":"Kelola akun dan peran staff"})]}),(0,a.jsxs)("button",{onClick:()=>Q(),className:"flex items-center gap-2 px-6 py-3 bg-[var(--color-accent)] text-white rounded-xl font-semibold hover:bg-[var(--color-accent-hover)] transition-colors",children:[(0,a.jsx)(n.Plus,{className:"w-5 h-5"}),"en"===w?"Add Staff":"Tambah Staff"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-6 border border-gray-100 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(m.BarChart3,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"en"===w?"Staff Performance":"Performa Staff"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"en"===w?"Revenue and order count per staff":"Revenue dan jumlah pesanan per staff"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>$("week"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"week"===O?"bg-[var(--color-accent)] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"en"===w?"7 Days":"7 Hari"}),(0,a.jsx)("button",{onClick:()=>$("month"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"month"===O?"bg-[var(--color-accent)] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"en"===w?"30 Days":"30 Hari"})]})]}),(0,a.jsx)("div",{className:"w-full h-80",children:0===H.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[(0,a.jsx)(x.TrendingUp,{className:"w-16 h-16 mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"Belum ada data performa"}),(0,a.jsx)("p",{className:"text-xs",children:"Pesanan dengan staff_id akan muncul di sini"})]}):(0,a.jsx)(v.ResponsiveContainer,{width:"100%",height:"100%",children:(0,a.jsxs)(f.BarChart,{data:H,layout:"vertical",margin:{left:80},children:[(0,a.jsx)(b.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,a.jsx)(g.XAxis,{type:"number",stroke:"#6b7280",style:{fontSize:"11px"}}),(0,a.jsx)(p.YAxis,{type:"category",dataKey:"name",stroke:"#6b7280",style:{fontSize:"11px"},width:75}),(0,a.jsx)(y.Tooltip,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(e,a)=>"revenue"===a?[`Rp ${Number(e).toLocaleString("id-ID")}`,"Revenue"]:"orders"===a?[e,"Pesanan"]:[e,a]}),(0,a.jsx)(j.Legend,{}),(0,a.jsx)(h.Bar,{dataKey:"revenue",fill:"#3b82f6",name:"Revenue (Rp)",radius:[0,4,4,0]}),(0,a.jsx)(h.Bar,{dataKey:"orders",fill:"#10b981",name:"Jumlah Pesanan",radius:[0,4,4,0]})]})})}),H.length>0&&(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-blue-50",children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 font-medium",children:"Total Revenue"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-blue-900",children:["Rp ",H.reduce((e,a)=>e+a.revenue,0).toLocaleString("id-ID")]})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-green-50",children:[(0,a.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"Total Pesanan"}),(0,a.jsx)("p",{className:"text-lg font-bold text-green-900",children:H.reduce((e,a)=>e+a.orders,0)})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-purple-50",children:[(0,a.jsx)("p",{className:"text-xs text-purple-600 font-medium",children:"Avg per Pesanan"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-purple-900",children:["Rp ",Math.round(H.reduce((e,a)=>e+a.revenue,0)/H.reduce((e,a)=>e+a.orders,0)).toLocaleString("id-ID")]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"bg-white rounded-2xl p-4 mb-6 border border-gray-100 shadow-sm",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Cari staff...",value:_,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("select",{value:D,onChange:e=>M(e.target.value),className:"px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,a.jsx)("option",{value:"all",children:"Semua Peran"}),U.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===P.length?(0,a.jsxs)("div",{className:"col-span-full bg-white rounded-2xl p-12 text-center border border-gray-100",children:[(0,a.jsx)(c.User,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:0===C.length?"Belum Ada Staff":"Tidak ada staff ditemukan"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:0===C.length?"Tambahkan staff pertama untuk mulai mengelola tim Anda":"Coba ubah filter atau kata kunci pencarian"}),0===C.length&&(0,a.jsxs)("button",{onClick:()=>Q(),className:"inline-flex items-center gap-2 px-6 py-3 bg-[var(--color-accent)] text-white rounded-xl font-semibold hover:bg-[var(--color-accent-hover)] transition-colors",children:[(0,a.jsx)(n.Plus,{className:"w-5 h-5"}),"Tambah Staff Pertama"]})]}):P.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.User,{className:"w-8 h-8 text-gray-400"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900",children:e.name}),(0,a.jsx)("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-semibold border ${"manager"===e.role?"bg-purple-100 text-purple-800 border-purple-200":"bg-blue-100 text-blue-800 border-blue-200"}`,children:e.role||"Tidak ada peran"})]})]}),(0,a.jsx)("div",{className:"space-y-2 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,a.jsx)(u.Phone,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.phone||"-"})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>Q(e),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[(0,a.jsx)(o.Edit2,{className:"w-4 h-4"}),"Edit"]}),(0,a.jsx)("button",{onClick:()=>Z(e.id),className:"px-4 py-2 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors",children:(0,a.jsx)(i.Trash2,{className:"w-4 h-4"})})]})]},e.id))})]}),A&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:q?"Edit Staff":"Tambah Staff"}),(0,a.jsxs)("form",{onSubmit:W,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Lengkap"}),(0,a.jsx)("input",{type:"text",required:!0,value:V.name,onChange:e=>G({...V,name:e.target.value}),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telepon"}),(0,a.jsx)("input",{type:"tel",value:V.phone,onChange:e=>G({...V,phone:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FF5A5F]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Peran"}),(0,a.jsx)("input",{type:"text",required:!0,value:V.role,onChange:e=>G({...V,role:e.target.value}),list:"role-suggestions",placeholder:"Contoh: manager, kang kopi, pembuat snack",className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all"}),(0,a.jsx)("datalist",{id:"role-suggestions",children:U.map(e=>(0,a.jsx)("option",{value:e.value},e.value))}),U.length>0&&(0,a.jsxs)("p",{className:"mt-2 text-xs text-gray-500",children:["Peran yang sudah ada: ",U.map(e=>e.label).join(", ")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PIN (4 digit)"}),(0,a.jsx)("input",{type:"password",maxLength:4,pattern:"[0-9]{4}",placeholder:q?"Kosongkan jika tidak diubah":"",required:!q,value:V.pin,onChange:e=>G({...V,pin:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FF5A5F]"})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>B(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Batal"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-[var(--color-accent)] text-white rounded-lg font-medium hover:bg-[var(--color-accent-hover)] transition-colors",children:q?"Simpan":"Tambah"})]})]})]})})]})}e.s(["default",()=>N])}]);