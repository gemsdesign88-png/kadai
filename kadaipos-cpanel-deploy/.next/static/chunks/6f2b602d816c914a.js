(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let a=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>a],71689)},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},7233,e=>{"use strict";let a=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],7233)},92930,e=>{"use strict";let a=(0,e.i(75254).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>a],92930)},27612,e=>{"use strict";let a=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],27612)},93946,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(18566),s=e.i(11795),l=e.i(7233),i=e.i(92930),n=e.i(27612),o=e.i(55436),c=e.i(51975);let d=(0,e.i(75254).default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var m=e.i(71689),u=e.i(44674);function g(){let e=(0,r.useRouter)(),g=(0,s.createClient)(),{language:x}=(0,u.useLanguage)(),[h,p]=(0,t.useState)(!0),[f,y]=(0,t.useState)([]),[b,v]=(0,t.useState)([]),[j,N]=(0,t.useState)(""),[w,k]=(0,t.useState)("all"),[_,C]=(0,t.useState)("all"),[S,K]=(0,t.useState)(!1),[M,T]=(0,t.useState)(!1),[A,E]=(0,t.useState)(null),[I,D]=(0,t.useState)(null),[L,q]=(0,t.useState)([]),[z,B]=(0,t.useState)([]),[P,U]=(0,t.useState)({name:"",description:"",price:"",category:"",category_id:null,stock:"",image_url:"",available:!0}),[H,R]=(0,t.useState)(""),[F,$]=(0,t.useState)(null);async function O(){p(!0);try{let{data:{user:a}}=await g.auth.getUser();if(!a)return void e.push("/login");let t=localStorage.getItem("selected_restaurant_id");if(!t)return void e.push("/dashboard");let{data:r}=await g.from("restaurants").select("*").eq("id",t).eq("owner_id",a.id).single();if(!r)return;D(r);let s=await G(r.id),{data:l}=await g.from("menu_items").select("*").eq("restaurant_id",r.id).order("name");if(l){let e=l.map(e=>{if(e.category_id){let a=s.find(a=>a.id===e.category_id);if(a){let t=a.parent_id?s.find(e=>e.id===a.parent_id):null;return{...e,menu_category:{...a,parent:t||void 0}}}}return e});y(e)}}catch(e){console.error("Error loading menu:",e)}finally{p(!1)}}async function G(e){try{let{data:a,error:t}=await g.from("menu_categories").select("*").eq("restaurant_id",e).order("name");if(t)return console.error("Error fetching categories:",t),q([]),B([]),[];let r=a||[];q(r);let s=r.filter(e=>!e.parent_id);return B(s),r}catch(e){return console.error("Error fetching categories:",e),q([]),B([]),[]}}function V(e){return L.filter(a=>a.parent_id===e)}function J(e=null){e?(E(e),U({name:e.name||"",description:e.description||"",price:e.price?.toString()||"",category:e.category||"",category_id:e.category_id||null,stock:e.stock?.toString()||"",image_url:e.image_url||"",available:e.available??!0})):(E(null),U({name:"",description:"",price:"",category:"",category_id:null,stock:"",image_url:"",available:!0})),K(!0)}async function Q(e){if(e.preventDefault(),!I)return;let a=P.category;if(P.category_id){let e=L.find(e=>e.id===P.category_id);e&&(a=e.parent_id?`${e.name} (${L.find(a=>a.id===e.parent_id)?.name})`:e.name)}let t={name:P.name,description:P.description,price:parseFloat(P.price),category:a,category_id:P.category_id,stock:parseInt(P.stock)||0,image_url:P.image_url,available:P.available,restaurant_id:I.id};try{A?await g.from("menu_items").update(t).eq("id",A.id):await g.from("menu_items").insert(t),K(!1),O()}catch(e){console.error("Error saving menu item:",e)}}async function W(e){if(e.preventDefault(),I&&H.trim())try{let{error:e}=await g.from("menu_categories").insert({name:H.trim(),parent_id:F,restaurant_id:I.id});if(e)throw e;T(!1),R(""),$(null),await G(I.id)}catch(e){console.error("Error creating category:",e),alert("en"===x?"Failed to create category":"Gagal membuat kategori")}}async function X(e){if(confirm("en"===x?"Delete this item from menu?":"Hapus item ini dari menu?"))try{await g.from("menu_items").delete().eq("id",e),O()}catch(e){console.error("Error deleting item:",e)}}return(0,t.useEffect)(()=>{O()},[]),(0,t.useEffect)(()=>{let e;e=f,"all"!==w&&(e="uncategorized"===w?e.filter(e=>!e.category_id):e.filter(e=>!!e.menu_category&&(e.menu_category.id===w||e.menu_category.parent_id===w))),"all"!==_&&(e=e.filter(e=>e.category_id===_)),j&&(e=e.filter(e=>e.name?.toLowerCase().includes(j.toLowerCase())||e.description?.toLowerCase().includes(j.toLowerCase()))),v(e)},[j,w,_,f]),h?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-accent)]"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>e.push("/dashboard/menu"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:(0,a.jsx)(m.ArrowLeft,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"en"===x?"Manage Menu":"Kelola Menu"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"en"===x?"Manage menu items, categories, and stock":"Atur menu, kategori, dan stok item"})]})]}),(0,a.jsxs)("button",{onClick:()=>J(),className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-accent)] text-white rounded-lg font-medium hover:bg-[var(--color-accent-hover)] transition-colors",children:[(0,a.jsx)(l.Plus,{className:"w-5 h-5"}),"en"===x?"Add Item":"Tambah Item"]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-4 mb-6 border border-gray-100 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(o.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"en"===x?"Search menu...":"Cari menu...",value:j,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("button",{onClick:()=>T(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors whitespace-nowrap",children:[(0,a.jsx)(c.Tag,{className:"w-4 h-4"}),"en"===x?"Manage Categories":"Kelola Kategori"]})})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[(0,a.jsxs)("select",{value:w,onChange:e=>{k(e.target.value),C("all")},className:"px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,a.jsx)("option",{value:"all",children:"en"===x?"All Categories":"Semua Kategori"}),z.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)),(0,a.jsx)("option",{value:"uncategorized",children:"en"===x?"Uncategorized":"Tanpa Kategori"})]}),"all"!==w&&"uncategorized"!==w&&(0,a.jsxs)("select",{value:_,onChange:e=>C(e.target.value),className:"px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,a.jsx)("option",{value:"all",children:"en"===x?"All Subcategories":"Semua Subkategori"}),V(w).map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===b.length?(0,a.jsx)("div",{className:"col-span-full bg-white rounded-2xl p-12 text-center border border-gray-100",children:(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"en"===x?"No items found":"Tidak ada item ditemukan"})}):b.map(e=>{var t;let r;return(0,a.jsxs)("div",{className:"bg-white rounded-2xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsx)("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:e.image_url?(0,a.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,a.jsx)("span",{className:"text-gray-400 text-4xl",children:"ðŸ½ï¸"})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-1",children:e.name}),e.menu_category?(0,a.jsx)("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:(t=e.menu_category)?t.parent?`${t.name} (${t.parent.name})`:t.name:""}):(0,a.jsx)("span",{className:"inline-block px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:e.category||("en"===x?"Uncategorized":"Tanpa Kategori")})]})}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.description||("en"===x?"No description":"Tidak ada deskripsi")}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(r=e.price,new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r))}),void 0!==e.stock&&(0,a.jsxs)("span",{className:`text-sm font-medium ${e.stock>10?"text-green-600":e.stock>0?"text-yellow-600":"text-red-600"}`,children:["en"===x?"Stock":"Stok",": ",e.stock]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>J(e),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[(0,a.jsx)(i.Edit2,{className:"w-4 h-4"}),"Edit"]}),(0,a.jsx)("button",{onClick:()=>X(e.id),className:"px-4 py-2 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors",children:(0,a.jsx)(n.Trash2,{className:"w-4 h-4"})})]})]})]},e.id)})})]}),S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:A?"Edit Item":"en"===x?"Add Item":"Tambah Item"}),(0,a.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Item Name":"Nama Item"}),(0,a.jsx)("input",{type:"text",required:!0,value:P.name,onChange:e=>U({...P,name:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Description":"Deskripsi"}),(0,a.jsx)("textarea",{value:P.description,onChange:e=>U({...P,description:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Price":"Harga"}),(0,a.jsx)("input",{type:"number",required:!0,value:P.price,onChange:e=>U({...P,price:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Category":"Kategori"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("select",{value:P.category_id||"",onChange:e=>U({...P,category_id:e.target.value||null}),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,a.jsx)("option",{value:"",children:"en"===x?"Select Category":"Pilih Kategori"}),z.map(e=>(0,a.jsxs)("optgroup",{label:e.name,children:[(0,a.jsx)("option",{value:e.id,children:e.name}),V(e.id).map(e=>(0,a.jsxs)("option",{value:e.id,children:["Â Â â†’ ",e.name]},e.id))]},e.id))]}),(0,a.jsxs)("button",{type:"button",onClick:()=>T(!0),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:["+ ","en"===x?"Create New Category":"Buat Kategori Baru"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Stock":"Stok"}),(0,a.jsx)("input",{type:"number",required:!0,value:P.stock,onChange:e=>U({...P,stock:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Image URL":"URL Gambar"}),(0,a.jsx)("input",{type:"url",value:P.image_url,onChange:e=>U({...P,image_url:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>K(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"en"===x?"Cancel":"Batal"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-[var(--color-accent)] text-white rounded-lg font-medium hover:bg-[var(--color-accent-hover)] transition-colors",children:A?"en"===x?"Save":"Simpan":"en"===x?"Add":"Tambah"})]})]})]})}),M&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"en"===x?"Manage Categories":"Kelola Kategori"}),(0,a.jsxs)("form",{onSubmit:W,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3",children:"en"===x?"Create New Category":"Buat Kategori Baru"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Category Name":"Nama Kategori"}),(0,a.jsx)("input",{type:"text",value:H,onChange:e=>R(e.target.value),placeholder:"en"===x?"e.g., Main Course, Dessert":"Contoh: Nasi Goreng, Main Course, Dessert",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"en"===x?"Parent Category (Optional)":"Parent Kategori (Opsional)"}),(0,a.jsxs)("select",{value:F||"",onChange:e=>$(e.target.value||null),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl font-medium focus:outline-none focus:border-gray-400 hover:border-gray-300 transition-all cursor-pointer",children:[(0,a.jsx)("option",{value:"",children:"en"===x?"No parent (Main Category)":"Tidak ada parent (Kategori Utama)"}),z.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsx)("button",{type:"submit",className:"w-full px-4 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors",children:"en"===x?"Add Category":"Tambah Kategori"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"en"===x?"Existing Categories":"Kategori yang Ada"}),0===z.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"en"===x?"No categories yet":"Belum ada kategori"}):(0,a.jsx)("div",{className:"space-y-3",children:z.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(d,{className:"w-5 h-5 text-gray-600"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["(",f.filter(a=>a.category_id===e.id||a.menu_category?.parent_id===e.id).length," ","items",")"]})]}),V(e.id).length>0&&(0,a.jsx)("div",{className:"ml-7 mt-2 space-y-1",children:V(e.id).map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,a.jsx)(c.Tag,{className:"w-4 h-4 text-gray-400"}),(0,a.jsx)("span",{children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["(",f.filter(a=>a.category_id===e.id).length," ","items",")"]})]},e.id))})]},e.id))})]}),(0,a.jsx)("div",{className:"flex gap-2 pt-6 mt-6 border-t",children:(0,a.jsx)("button",{onClick:()=>T(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"en"===x?"Close":"Tutup"})})]})})]})}e.s(["default",()=>g],93946)}]);