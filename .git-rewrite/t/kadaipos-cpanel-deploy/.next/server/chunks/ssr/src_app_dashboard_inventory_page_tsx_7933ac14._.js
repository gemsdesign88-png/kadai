module.exports=[92532,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95445),f=a.i(21979),g=a.i(83497),h=a.i(73570),i=a.i(53277),j=a.i(90166),k=a.i(87532),l=a.i(25910),m=a.i(64321),n=a.i(40344),o=a.i(67149),p=a.i(48662),q=a.i(59854),r=a.i(2274);function s(){let a=(0,d.useRouter)(),s=(0,e.createClient)(),{language:t}=(0,f.useLanguage)(),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)("add"),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)({totalValue:0,lowStock:0,outOfStock:0,totalItems:0}),[M,N]=(0,c.useState)([]);async function O(){v(!0);try{let{data:{user:b}}=await s.auth.getUser();if(!b)return void a.push("/login");let c=localStorage.getItem("selected_restaurant_id");if(!c)return void a.push("/dashboard");let{data:d}=await s.from("restaurants").select("*").eq("id",c).eq("owner_id",b.id).single();if(!d)return;let{data:e}=await s.from("stock_items").select(`
          *,
          ingredient:ingredients(*)
        `).eq("restaurant_id",d.id).order("quantity_on_hand",{ascending:!0});if(e){x(e);let a=e.reduce((a,b)=>a+b.quantity_on_hand*(b.ingredient?.unit_cost||0),0),b=e.filter(a=>a.quantity_on_hand>0&&a.quantity_on_hand<=(a.ingredient?.reorder_level||0)).length,c=e.filter(a=>0===a.quantity_on_hand).length;L({totalValue:a,lowStock:b,outOfStock:c,totalItems:e.length});let d=e.filter(a=>{let b=a.quantity_on_hand,c=a.ingredient?.par_level||100,d=a.ingredient?.reorder_level||20;return b>d&&b<=c}).length,f=e.filter(a=>{let b=a.quantity_on_hand,c=a.ingredient?.par_level||100;return b>c}).length;N([{name:"Healthy",value:d,color:"#10b981"},{name:"Low Stock",value:b,color:"#f59e0b"},{name:"Out of Stock",value:c,color:"#ef4444"},{name:"Overstocked",value:f,color:"#3b82f6"}].filter(a=>a.value>0))}}catch(a){console.error("Error loading inventory:",a)}finally{v(!1)}}async function P(a){if(a.preventDefault(),!A)return;let b=parseFloat(E),c="add"===C?A.quantity_on_hand+b:A.quantity_on_hand-b;if(c<0)return void alert("Stok tidak boleh negatif");try{let a=c<=A.ingredient.reorder_level;await s.from("stock_items").update({quantity_on_hand:c,is_low_stock:a}).eq("id",A.id),z(!1),O()}catch(a){console.error("Error adjusting stock:",a)}}(0,c.useEffect)(()=>{O()},[]);let Q=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),R=w.filter(a=>a.ingredient.name.toLowerCase().includes(I.toLowerCase())||a.ingredient.category.toLowerCase().includes(I.toLowerCase()));return u?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-accent)]"})}):(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"en"===t?"Manage Stock":"Kelola Stok"}),(0,b.jsx)("p",{className:"text-gray-600",children:"en"===t?"Monitor and adjust inventory":"Pantau dan sesuaikan inventory"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsx)("div",{className:"bg-white rounded-2xl p-6 border border-gray-100 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(j.DollarSign,{className:"w-6 h-6 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:Q(K.totalValue)}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===t?"Total Stock Value":"Total Nilai Stok"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-2xl p-6 border border-gray-100 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(g.Package,{className:"w-6 h-6 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:K.totalItems}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===t?"Total Items":"Total Item"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-2xl p-6 border-l-4 border-red-500 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(h.AlertTriangle,{className:"w-6 h-6 text-red-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-3xl font-bold text-gray-900",children:K.outOfStock}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===t?"Out of Stock":"Item Habis"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-2xl p-6 border-l-4 border-yellow-500 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(i.TrendingDown,{className:"w-6 h-6 text-yellow-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-3xl font-bold text-gray-900",children:K.lowStock}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===t?"Low Stock":"Stok Rendah"})]})]})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-6 border border-gray-100 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center",children:(0,b.jsx)(l.PieChart,{className:"w-5 h-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"en"===t?"Stock Status Distribution":"Distribusi Status Stok"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"en"===t?"Breakdown of inventory item status":"Breakdown status inventory items"})]})]}),(0,b.jsx)("div",{className:"w-full h-80",children:0===M.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[(0,b.jsx)(g.Package,{className:"w-16 h-16 mb-3 opacity-50"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:"Belum ada data stok"}),(0,b.jsx)("p",{className:"text-xs",children:"Tambahkan ingredients untuk melihat distribusi"})]}):(0,b.jsx)(p.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(m.PieChart,{children:[(0,b.jsx)(n.Pie,{data:M,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:b})=>`${a}: ${(100*(b||0)).toFixed(0)}%`,outerRadius:120,fill:"#8884d8",dataKey:"value",children:M.map((a,c)=>(0,b.jsx)(o.Cell,{fill:a.color},`cell-${c}`))}),(0,b.jsx)(q.Tooltip,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:a=>[`${a} ${"en"===t?"items":"item"}`,"en"===t?"Quantity":"Jumlah"]}),(0,b.jsx)(r.Legend,{verticalAlign:"bottom",height:36,formatter:(a,b)=>{let c=M.find(b=>b.name===a);return`${a} (${c?.value||0} ${"en"===t?"items":"item"})`}})]})})}),M.length>0&&(0,b.jsx)("div",{className:"mt-4 grid grid-cols-4 gap-4",children:M.map((a,c)=>(0,b.jsxs)("div",{className:"p-3 rounded-lg border-2",style:{borderColor:a.color,backgroundColor:`${a.color}10`},children:[(0,b.jsx)("p",{className:"text-xs font-medium",style:{color:a.color},children:a.name}),(0,b.jsx)("p",{className:"text-2xl font-bold",style:{color:a.color},children:a.value}),(0,b.jsx)("p",{className:"text-xs",style:{color:a.color},children:"en"===t?"items":"item"})]},c))})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Search,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",value:I,onChange:a=>J(a.target.value),placeholder:"en"===t?"Search ingredients...":"Cari ingredient...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)] transition-all"})]})}),(0,b.jsx)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"en"===t?"Ingredient":"Bahan"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"en"===t?"Category":"Kategori"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"en"===t?"Current Stock":"Stok Saat Ini"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"Reorder Level"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"Par Level"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"en"===t?"Value":"Nilai"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===R.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:I?"en"===t?"No items match your search":"Tidak ada item yang cocok dengan pencarian":"en"===t?"No items in inventory":"Tidak ada item dalam inventory"})}):R.map(a=>{let c,d,e,f,h=(c=a.quantity_on_hand,d=a.ingredient.par_level||100,e=a.ingredient.reorder_level||20,f=c/d*100,0===c?{label:"en"===t?"Out of Stock":"Habis",color:"bg-red-600 text-white",percentage:0}:c<=e?{label:"en"===t?"Very Low":"Sangat Rendah",color:"bg-red-500 text-white",percentage:f}:f<50?{label:"en"===t?"Low":"Rendah",color:"bg-orange-500 text-white",percentage:f}:f<80?{label:"en"===t?"Medium":"Sedang",color:"bg-yellow-500 text-white",percentage:f}:f<=120?{label:"en"===t?"Good":"Baik",color:"bg-green-500 text-white",percentage:f}:{label:"en"===t?"Overstocked":"Berlebih",color:"bg-blue-500 text-white",percentage:f}),i=a.quantity_on_hand*a.ingredient.unit_cost;return(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)(g.Package,{className:"w-6 h-6 text-gray-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:a.ingredient.name}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.ingredient.unit})]})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:"inline-block px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:a.ingredient.category})}),(0,b.jsxs)("td",{className:"px-6 py-4 text-center",children:[(0,b.jsx)("span",{className:"text-xl font-bold text-gray-900",children:a.quantity_on_hand}),(0,b.jsx)("span",{className:"text-sm text-gray-500 ml-1",children:a.ingredient.unit})]}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:(0,b.jsxs)("span",{className:"text-sm text-gray-600",children:[a.ingredient.reorder_level," ",a.ingredient.unit]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:(0,b.jsxs)("span",{className:"text-sm text-gray-600",children:[a.ingredient.par_level," ",a.ingredient.unit]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,b.jsx)("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-semibold ${h.color}`,children:h.label}),h.percentage>0&&(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(h.percentage),"%"]})]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-right",children:(0,b.jsx)("span",{className:"font-medium text-gray-900",children:Q(i)})})]},a.id)})})]})})})]}),y&&A&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"add"===C?"Tambah Stok":"Kurangi Stok"}),(0,b.jsxs)("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:A.ingredient.name}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Stok saat ini: ",(0,b.jsxs)("span",{className:"font-bold",children:[A.quantity_on_hand," ",A.ingredient.unit]})]})]}),(0,b.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Jumlah (",A.ingredient.unit,")"]}),(0,b.jsx)("input",{type:"number",min:"0.01",step:"0.01",required:!0,value:E,onChange:a=>F(a.target.value),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]",placeholder:"Masukkan jumlah"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catatan (opsional)"}),(0,b.jsx)("textarea",{value:G,onChange:a=>H(a.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-accent)]",placeholder:"Alasan penyesuaian stok"})]}),E&&(0,b.jsx)("div",{className:"p-4 bg-blue-50 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-gray-700",children:["Stok baru: ",(0,b.jsxs)("span",{className:"font-bold text-blue-700",children:["add"===C?A.quantity_on_hand+parseFloat(E):A.quantity_on_hand-parseFloat(E)," ",A.ingredient.unit]})]})}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>z(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Batal"}),(0,b.jsx)("button",{type:"submit",className:`flex-1 px-4 py-2 text-white rounded-lg font-medium transition-colors ${"add"===C?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600"}`,children:"add"===C?"Tambah":"Kurangi"})]})]})]})})]})}a.s(["default",()=>s])}];

//# sourceMappingURL=src_app_dashboard_inventory_page_tsx_7933ac14._.js.map