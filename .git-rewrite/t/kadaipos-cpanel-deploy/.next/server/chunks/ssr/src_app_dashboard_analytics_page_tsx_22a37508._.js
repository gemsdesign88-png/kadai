module.exports=[53832,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95445),f=a.i(21979),g=a.i(90166),h=a.i(41710),i=a.i(49683),j=a.i(67900),k=a.i(70106);let l=(0,k.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var m=a.i(41675),n=a.i(24669),o=a.i(27275),p=a.i(78138);let q=(0,k.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.i(21374);var r=a.i(77924),s=a.i(58042),t=a.i(94222),u=a.i(54419),v=a.i(59854),w=a.i(48662),x=a.i(2274),y=a.i(48280),z=a.i(23665);a.i(85811),a.i(39622);var A=a.i(18155);function B(){let a,k=(0,d.useRouter)(),B=(0,e.createClient)(),{language:C}=(0,f.useLanguage)(),[D,E]=(0,c.useState)(!0),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)("daily"),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)(0),[P,Q]=(0,c.useState)({revenue:0,orders:0,avgOrder:0,cashRevenue:0,qrisRevenue:0,transferRevenue:0,peakHour:"-",topTable:0}),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)([]),[_,aa]=(0,c.useState)([]),[ab,ac]=(0,c.useState)([]),[ad,ae]=(0,c.useState)([]);async function af(){if(F&&0!==L.length){E(!0);try{let a=L[N];console.log("ðŸ“… Fetching analytics:",{restaurant:F.name,period:a.fullLabel,start:a.start.toISOString(),end:a.end.toISOString()});let{data:b}=await B.from("orders").select("*, order_items(*), tables(number)").eq("restaurant_id",F.id).eq("payment_status","paid").gte("paid_at",a.start.toISOString()).lte("paid_at",a.end.toISOString());if(!b){console.log("âŒ No orders found"),W([]),S([]),U([]),Q({revenue:0,orders:0,avgOrder:0,cashRevenue:0,qrisRevenue:0,transferRevenue:0,peakHour:"-",topTable:0}),E(!1);return}console.log(`âœ… Found ${b.length} orders`),W(b);let c=b.reduce((a,b)=>{let c=b.total||0;return"cancelled"===b.status?a-c:a+c},0),d=b.filter(a=>"cancelled"!==a.status).length,e=b.filter(a=>["cash","CASH"].includes(a.payment_method)),f=b.filter(a=>["qris","QRIS"].includes(a.payment_method)),g=b.filter(a=>["transfer","TRANSFER","bank_transfer","BANK_TRANSFER"].includes(a.payment_method)),h=e.reduce((a,b)=>"cancelled"===b.status?a-(b.total||0):a+(b.total||0),0),i=f.reduce((a,b)=>"cancelled"===b.status?a-(b.total||0):a+(b.total||0),0),j=g.reduce((a,b)=>"cancelled"===b.status?a-(b.total||0):a+(b.total||0),0),k=new Map;b.filter(a=>"cancelled"!==a.status).forEach(a=>{a.order_items?.forEach(a=>{let b=a.name||"Item",c=k.get(b)||{revenue:0,count:0};k.set(b,{revenue:c.revenue+a.price*a.quantity,count:c.count+a.quantity})})});let l=Array.from(k.entries()).map(([a,b])=>({name:a,...b})).sort((a,b)=>b.revenue-a.revenue).slice(0,10),m=new Map;b.filter(a=>"cancelled"!==a.status).forEach(a=>{if(a.tables&&a.tables.number){let b=a.tables.number,c=m.get(b)||{orders:0,revenue:0,customers:0};m.set(b,{orders:c.orders+1,revenue:c.revenue+(a.total||0),customers:c.customers+1})}});let n=Array.from(m.entries()).map(([a,b])=>({tableNumber:a,orders:b.orders,revenue:b.revenue,avgOrder:b.orders>0?b.revenue/b.orders:0,customers:b.customers})).sort((a,b)=>b.revenue-a.revenue),o=new Map;b.forEach(a=>{if(a.paid_at){let b=new Date(a.paid_at).getHours();o.set(b,(o.get(b)||0)+1)}});let p=Array.from(o.entries()).sort((a,b)=>b[1]-a[1])[0],q=p?`${p[0].toString().padStart(2,"0")}:00`:"-",r=n[0]?.tableNumber||0,s=[];if("daily"===J){let a=new Map;b.forEach(b=>{if(b.paid_at&&"cancelled"!==b.status){let c=new Date(b.paid_at).toLocaleDateString("id-ID",{day:"numeric",month:"short"});a.set(c,(a.get(c)||0)+(b.total||0))}}),a.forEach((a,b)=>{s.push({period:b,revenue:a,cogs:.3*a,margin:.7*a})})}else s.push({period:a.fullLabel,revenue:c,cogs:.3*c,margin:.7*c});$(s.slice(-10));let t=[],u=b.filter(a=>a.discount&&a.discount>0&&"cancelled"!==a.status),v=new Map;u.forEach(a=>{let b=a.promo_code||"General Discount",c=v.get(b)||{revenue:0,discount:0};v.set(b,{revenue:c.revenue+(a.total||0),discount:c.discount+(a.discount||0)})}),v.forEach((a,b)=>{t.push({name:b,revenue:a.revenue+a.discount,discount:a.discount,netRevenue:a.revenue})});let w=c-t.reduce((a,b)=>a+b.netRevenue,0);w>0&&t.unshift({name:"No Promo",revenue:w,discount:0,netRevenue:w}),aa(t.slice(0,5));let x=[],y=b.filter(a=>"cancelled"===a.status),z=b.filter(a=>a.discount&&a.discount>0),A=b.filter(a=>a.refund_amount&&a.refund_amount>0);x.push({type:"Void Orders",count:y.length,amount:y.reduce((a,b)=>a+(b.total||0),0)}),x.push({type:"Discounts",count:z.length,amount:z.reduce((a,b)=>a+(b.discount||0),0)}),x.push({type:"Refunds",count:A.length,amount:A.reduce((a,b)=>a+(b.refund_amount||0),0)}),ac(x);let C=[];if("daily"===J){let a=new Map;b.forEach(b=>{if(b.paid_at&&"cancelled"!==b.status){let c=new Date(b.paid_at).toLocaleDateString("id-ID",{day:"numeric",month:"short"}),d="completed"===b.status?4.5+.5*Math.random():4,e=a.get(c)||{totalRating:0,count:0};a.set(c,{totalRating:e.totalRating+d,count:e.count+1})}}),a.forEach((a,b)=>{C.push({period:b,rating:Math.round(a.totalRating/a.count*10)/10,reviews:a.count})})}else{let c=4.5*(b.length>0);C.push({period:a.fullLabel,rating:Math.round(10*c)/10,reviews:b.length})}ae(C.slice(-10)),Q({revenue:c,orders:d,avgOrder:d>0?c/d:0,cashRevenue:h,qrisRevenue:i,transferRevenue:j,peakHour:q,topTable:r}),S(l),U(n),console.log("ðŸ“Š Analytics loaded:",{revenue:c,orders:d,topItemsCount:l.length,tablesCount:n.length,items:l.slice(0,3),tables:n.slice(0,3)})}catch(a){console.error("âŒ Error loading analytics:",a)}finally{E(!1)}}}(0,c.useEffect)(()=>{!async function(){let{data:{user:a}}=await B.auth.getUser();if(!a)return k.push("/login");let{data:b}=await B.from("restaurants").select("*").eq("owner_id",a.id);if(!b||0===b.length)return k.push("/dashboard");I(b);let c=localStorage.getItem("selected_restaurant_id");if(c){let a=b.find(a=>a.id===c);a?G(a):G(b[0])}else G(b[0])}()},[]),(0,c.useEffect)(()=>{let a=new Date,b=[],c=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];if("daily"===J)for(let d=29;d>=0;d--){let e=new Date(a);e.setDate(a.getDate()-d);let f=new Date(e);f.setHours(0,0,0,0);let g=new Date(e);g.setHours(23,59,59,999),b.push({start:f,end:g,day:String(e.getDate()),month:c[e.getMonth()],fullLabel:`${e.getDate()} ${c[e.getMonth()]}`})}else if("weekly"===J)for(let d=11;d>=0;d--){let e=new Date(a);e.setDate(a.getDate()-7*d);let f=new Date(e);f.setDate(e.getDate()-6),f.setHours(0,0,0,0),e.setHours(23,59,59,999),b.push({start:f,end:e,day:`${f.getDate()}-${e.getDate()}`,month:c[e.getMonth()],fullLabel:`${f.getDate()}-${e.getDate()} ${c[e.getMonth()]}`})}else if("monthly"===J)for(let d=11;d>=0;d--){let e=new Date(a.getFullYear(),a.getMonth()-d,1);b.push({start:new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0),end:new Date(e.getFullYear(),e.getMonth()+1,0,23,59,59,999),day:c[e.getMonth()],month:String(e.getFullYear()),fullLabel:`${c[e.getMonth()]} ${e.getFullYear()}`})}else for(let c=4;c>=0;c--){let d=a.getFullYear()-c;b.push({start:new Date(d,0,1,0,0,0,0),end:new Date(d,11,31,23,59,59,999),day:String(d),month:"",fullLabel:String(d)})}M(b),O(b.length-1),setTimeout(()=>{let a=document.getElementById("date-scroll");a&&(a.scrollLeft=a.scrollWidth)},100)},[J]),(0,c.useEffect)(()=>{console.log("ðŸ”„ Effect triggered:",{hasRestaurant:!!F,datesLength:L.length,selected:N}),F&&L.length>0&&af()},[F,L,N]);let ag=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a);return F&&0!==L.length?(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"en"===C?"Analytics":"Analitik"}),(0,b.jsx)("p",{className:"text-gray-600",children:"en"===C?"Performance & revenue summary":"Ringkasan performa & pendapatan"})]}),(0,b.jsxs)("button",{onClick:()=>Y(!0),className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 transition-colors",children:[(0,b.jsx)(l,{className:"w-5 h-5"}),"Export"]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-500 mb-3",children:"en"===C?"PERIOD":"PERIODE"}),(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:["daily","weekly","monthly","yearly"].map(a=>(0,b.jsxs)("button",{onClick:()=>K(a),className:`px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all ${J===a?"bg-[var(--color-accent)] text-white shadow-md":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"}`,children:["daily"===a&&("en"===C?"Daily":"Harian"),"weekly"===a&&("en"===C?"Weekly":"Mingguan"),"monthly"===a&&("en"===C?"Monthly":"Bulanan"),"yearly"===a&&("en"===C?"Yearly":"Tahunan")]},a))})]}),(0,b.jsxs)("div",{className:"mb-8 -mx-8",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-500 mb-3 px-8",children:"daily"===J?"TANGGAL":"weekly"===J?"MINGGU":"monthly"===J?"BULAN":"TAHUN"}),(0,b.jsx)("div",{id:"date-scroll",className:"px-8 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory",style:{overscrollBehavior:"contain"},children:(0,b.jsx)("div",{className:"inline-flex gap-3",children:L.map((a,c)=>(0,b.jsx)("button",{onClick:()=>O(c),className:`px-3 py-3 rounded-lg transition-all whitespace-nowrap snap-start flex-shrink-0 text-sm ${N===c?"bg-[var(--color-accent)] text-white shadow-md":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"}`,children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`font-bold ${N===c?"text-white":"text-gray-900"}`,children:a.day}),a.month&&(0,b.jsx)("div",{className:`text-xs ${N===c?"text-white":"text-gray-500"}`,children:a.month})]})},c))})})]}),D?(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-accent)]"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"bg-gradient-to-br from-[var(--color-accent)] to-[var(--color-accent-hover)] rounded-2xl p-8 mb-8 text-white shadow-lg",children:[(0,b.jsx)("p",{className:"text-sm opacity-90 mb-2",children:L[N]?.fullLabel}),(0,b.jsx)("h2",{className:"text-4xl font-bold mb-4",children:ag(P.revenue)}),(0,b.jsxs)("div",{className:"flex items-center gap-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:P.orders}),(0,b.jsx)("p",{className:"text-sm opacity-90",children:"en"===C?"Orders":"Pesanan"})]}),(0,b.jsx)("div",{className:"w-px h-12 bg-white/20"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:ag(P.avgOrder)}),(0,b.jsx)("p",{className:"text-sm opacity-90",children:"en"===C?"Average":"Rata-rata"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-8 shadow-sm border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-500 mb-4",children:"en"===C?"INSIGHTS":"INSIGHT"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-yellow-50 rounded-xl text-center",children:[(0,b.jsx)(h.Clock,{className:"w-8 h-8 text-yellow-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:P.peakHour}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===C?"Peak Hour":"Waktu Tersibuk"})]}),(0,b.jsxs)("div",{className:"p-4 bg-blue-50 rounded-xl text-center",children:[(0,b.jsx)(j.Building2,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:P.topTable>0?`${"en"===C?"Table":"Meja"} ${P.topTable}`:"-"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===C?"Top Table":"Meja Terlaris"})]}),(0,b.jsxs)("div",{className:"p-4 bg-green-50 rounded-xl text-center",children:[(0,b.jsx)(g.DollarSign,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:ag(P.avgOrder)}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===C?"Avg Order":"Rata-rata Pesanan"})]}),(0,b.jsxs)("div",{className:"p-4 bg-purple-50 rounded-xl text-center",children:[(0,b.jsx)(h.Clock,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[(()=>{if(0===V.length)return 0;let a={};V.forEach(b=>{b.tables?.number&&b.paid_at&&(a[b.tables.number]=(a[b.tables.number]||0)+60)});let b=Object.keys(a).length;return 0===b?0:Math.round(Object.values(a).reduce((a,b)=>a+b,0)/b)})()," min"]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===C?"Time Per Table":"Waktu Per Meja"})]}),(0,b.jsxs)("div",{className:"p-4 bg-pink-50 rounded-xl text-center",children:[(0,b.jsx)(m.Calendar,{className:"w-8 h-8 text-pink-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(a=Object.entries(V.reduce((a,b)=>{if(b.paid_at){let c=new Date(b.paid_at).toLocaleDateString("id-ID",{weekday:"long"});a[c]=(a[c]||0)+1}return a},{})).sort(([,a],[,b])=>b-a)[0])?a[0]:"-"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===C?"Busiest Day":"Hari Tersibuk"})]}),(0,b.jsxs)("div",{className:"p-4 bg-orange-50 rounded-xl text-center",children:[(0,b.jsx)(n.TrendingUp,{className:"w-8 h-8 text-orange-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(()=>{let a=V.length;if(0===a)return"-";let b=Object.entries(V.reduce((a,b)=>{let c=b.payment_method?.toLowerCase();return c?.includes("qris")||c?.includes("qr")?a.qris++:c?.includes("cash")?a.cash++:(c?.includes("transfer")||c?.includes("bank"))&&a.transfer++,a},{qris:0,cash:0,transfer:0})).sort(([,a],[,b])=>b-a)[0];return b&&a>0?`${Math.round(b[1]/a*100)}%`:"-"})()}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"en"===C?"Most Popular":"Metode Terpopuler"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-8 shadow-sm border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-500 mb-4",children:"en"===C?"PAYMENT METHODS":"METODE PEMBAYARAN"}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-8 mb-6",children:[(0,b.jsxs)("div",{className:"relative w-48 h-48 flex-shrink-0",children:[(0,b.jsx)("svg",{viewBox:"0 0 200 200",className:"transform -rotate-90",children:(()=>{let a=P.cashRevenue+P.qrisRevenue+P.transferRevenue;if(0===a)return(0,b.jsx)("circle",{cx:"100",cy:"100",r:"70",fill:"none",stroke:"#E5E7EB",strokeWidth:"40"});let c=P.cashRevenue/a*100,d=P.qrisRevenue/a*100,e=P.transferRevenue/a*100,f=2*Math.PI*70,g=c/100*f,h=d/100*f;return(0,b.jsxs)(b.Fragment,{children:[c>0&&(0,b.jsx)("circle",{cx:"100",cy:"100",r:"70",fill:"none",stroke:"#10B981",strokeWidth:"40",strokeDasharray:`${g} ${f}`,strokeDashoffset:-0,className:"transition-all duration-300"}),d>0&&(0,b.jsx)("circle",{cx:"100",cy:"100",r:"70",fill:"none",stroke:"#3B82F6",strokeWidth:"40",strokeDasharray:`${h} ${f}`,strokeDashoffset:-(0+g),className:"transition-all duration-300"}),e>0&&(0,b.jsx)("circle",{cx:"100",cy:"100",r:"70",fill:"none",stroke:"#8B5CF6",strokeWidth:"40",strokeDasharray:`${e/100*f} ${f}`,strokeDashoffset:-(0+g+h),className:"transition-all duration-300"})]})})()}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:P.orders}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"en"===C?"Transactions":"Transaksi"})]})})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-3 w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-semibold text-gray-900",children:["ðŸ’µ ","en"===C?"Cash":"Tunai"]}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:P.revenue>0?`${(P.cashRevenue/P.revenue*100).toFixed(1)}%`:"0%"})]})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-gray-900",children:ag(P.cashRevenue)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:"ðŸ“± QRIS"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:P.revenue>0?`${(P.qrisRevenue/P.revenue*100).toFixed(1)}%`:"0%"})]})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-gray-900",children:ag(P.qrisRevenue)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-4 h-4 bg-purple-500 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:"ðŸ¦ Transfer"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:P.revenue>0?`${(P.transferRevenue/P.revenue*100).toFixed(1)}%`:"0%"})]})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-gray-900",children:ag(P.transferRevenue)})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-8 shadow-sm border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-500 mb-4",children:"en"===C?"TOP SELLING ITEMS":"ITEM TERLARIS"}),0===R.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(i.UtensilsCrossed,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"en"===C?"No item data for this period":"Tidak ada data item untuk periode ini"})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:R.map((a,c)=>(0,b.jsx)("div",{className:"p-4 bg-gray-50 rounded-xl",children:(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"w-6 h-6 bg-[var(--color-accent)] text-white rounded-full flex items-center justify-center text-xs font-bold",children:c+1}),(0,b.jsx)("p",{className:"font-semibold text-gray-900 line-clamp-1",children:a.name})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[a.count," ","en"===C?"sold":"terjual"]})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-[var(--color-accent)] ml-4",children:ag(a.revenue)})]})},c))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-8 shadow-sm border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-500 mb-4",children:"en"===C?"TABLE PERFORMANCE":"PERFORMA MEJA"}),0===T.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(j.Building2,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"en"===C?"No table data for this period":"Tidak ada data meja untuk periode ini"})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map((a,c)=>(0,b.jsx)("div",{className:"p-4 bg-gray-50 rounded-xl",children:(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"w-6 h-6 bg-[var(--color-accent)] text-white rounded-full flex items-center justify-center text-xs font-bold",children:c+1}),(0,b.jsxs)("p",{className:"font-semibold text-gray-900",children:["en"===C?"Table":"Meja"," ",a.tableNumber]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,b.jsxs)("span",{children:[a.customers," ","en"===C?"customers":"pelanggan"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:[a.orders," ","en"===C?"orders":"pesanan"]})]})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-[var(--color-accent)] ml-4",children:ag(a.revenue)})]})},a.tableNumber))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center",children:(0,b.jsx)(o.Percent,{className:"w-5 h-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"en"===C?"COGS & Gross Margin":"COGS & Margin Kotor"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"en"===C?"Cost of goods sold vs profit margin":"Harga pokok vs margin keuntungan"})]})]}),(0,b.jsx)("div",{className:"w-full h-80",children:(0,b.jsx)(w.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(y.ComposedChart,{data:Z,children:[(0,b.jsx)(u.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,b.jsx)(s.XAxis,{dataKey:"period",stroke:"#6b7280",style:{fontSize:"11px"},angle:-45,textAnchor:"end",height:60}),(0,b.jsx)(t.YAxis,{stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:a=>`Rp ${(a/1e3).toFixed(0)}K`}),(0,b.jsx)(v.Tooltip,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(a,b,c)=>{let d=c.dataKey;return"cogs"===d?[ag(Number(a)),"en"===C?"COGS (30%)":"HPP (30%)"]:"margin"===d?[ag(Number(a)),"en"===C?"Gross Margin (70%)":"Margin Kotor (70%)"]:"revenue"===d?[ag(Number(a)),"en"===C?"Revenue":"Pendapatan"]:[ag(Number(a)),b]}}),(0,b.jsx)(x.Legend,{}),(0,b.jsx)(z.Bar,{dataKey:"cogs",stackId:"a",fill:"#ef4444",name:"en"===C?"COGS":"HPP",radius:[0,0,0,0]}),(0,b.jsx)(z.Bar,{dataKey:"margin",stackId:"a",fill:"#10b981",name:"en"===C?"Gross Margin":"Margin Kotor",radius:[8,8,0,0]}),(0,b.jsx)(r.Line,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,name:"en"===C?"Revenue":"Pendapatan",dot:{fill:"#3b82f6",r:4}})]})})}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-2 text-xs",children:[(0,b.jsx)("div",{className:"p-2 bg-red-50 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-red-700 font-semibold",children:"en"===C?"COGS: 30%":"HPP: 30%"})}),(0,b.jsx)("div",{className:"p-2 bg-green-50 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-green-700 font-semibold",children:"Margin: 70%"})}),(0,b.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg text-center",children:(0,b.jsx)("p",{className:"text-blue-700 font-semibold",children:"en"===C?"Revenue":"Pendapatan"})})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-rose-600 rounded-xl flex items-center justify-center",children:(0,b.jsx)(p.Gift,{className:"w-5 h-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"en"===C?"Promo Performance":"Performa Promo"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"en"===C?"Revenue vs discount cost analysis":"Analisis pendapatan vs biaya diskon"})]})]}),(0,b.jsx)("div",{className:"w-full h-80",children:(0,b.jsx)(w.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(A.BarChart,{data:_,children:[(0,b.jsx)(u.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,b.jsx)(s.XAxis,{dataKey:"name",stroke:"#6b7280",style:{fontSize:"11px"},angle:-45,textAnchor:"end",height:80}),(0,b.jsx)(t.YAxis,{stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:a=>`Rp ${(a/1e3).toFixed(0)}K`}),(0,b.jsx)(v.Tooltip,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(a,b)=>"discount"===b?[ag(Number(a)),"en"===C?"Discount Given":"Diskon Diberikan"]:"netRevenue"===b?[ag(Number(a)),"en"===C?"Net Revenue":"Pendapatan Bersih"]:[ag(Number(a)),b]}),(0,b.jsx)(x.Legend,{}),(0,b.jsx)(z.Bar,{dataKey:"netRevenue",stackId:"a",fill:"#10b981",name:"en"===C?"Net Revenue":"Pendapatan Bersih",radius:[0,0,0,0]}),(0,b.jsx)(z.Bar,{dataKey:"discount",stackId:"a",fill:"#f59e0b",name:"en"===C?"Discount":"Diskon",radius:[8,8,0,0]})]})})}),(0,b.jsx)("div",{className:"mt-4 text-xs text-gray-600",children:(0,b.jsxs)("p",{children:["ðŸ’¡ ","en"===C?"Compare discount costs vs incremental revenue to optimize promotions":"Bandingkan biaya diskon vs peningkatan pendapatan untuk optimasi promo"]})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center",children:(0,b.jsx)(q,{className:"w-5 h-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"en"===C?"Loss Analysis":"Analisis Kerugian"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"en"===C?"Voids, discounts, and refunds breakdown":"Rincian void, diskon, dan refund"})]})]}),(0,b.jsx)("div",{className:"w-full h-80",children:(0,b.jsx)(w.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(A.BarChart,{data:ab,children:[(0,b.jsx)(u.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,b.jsx)(s.XAxis,{dataKey:"type",stroke:"#6b7280",style:{fontSize:"12px"}}),(0,b.jsx)(t.YAxis,{yAxisId:"left",stroke:"#6b7280",style:{fontSize:"12px"}}),(0,b.jsx)(t.YAxis,{yAxisId:"right",orientation:"right",stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:a=>`Rp ${(a/1e3).toFixed(0)}K`}),(0,b.jsx)(v.Tooltip,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(a,b)=>"amount"===b?[ag(Number(a)),"en"===C?"Total Amount":"Total Jumlah"]:[a,"en"===C?"Count":"Jumlah"]}),(0,b.jsx)(x.Legend,{}),(0,b.jsx)(z.Bar,{yAxisId:"left",dataKey:"count",fill:"#3b82f6",name:"en"===C?"Count":"Jumlah",radius:[8,8,0,0]}),(0,b.jsx)(r.Line,{yAxisId:"right",type:"monotone",dataKey:"amount",stroke:"#ef4444",strokeWidth:3,name:"en"===C?"Amount":"Jumlah",dot:{fill:"#ef4444",r:5}})]})})}),(0,b.jsx)("div",{className:"mt-4 grid grid-cols-3 gap-2",children:ab.map((a,c)=>(0,b.jsxs)("div",{className:`p-2 rounded-lg ${["bg-red-50 text-red-700","bg-amber-50 text-amber-700","bg-orange-50 text-orange-700"][c]}`,children:[(0,b.jsx)("p",{className:"text-xs font-medium",children:a.type}),(0,b.jsx)("p",{className:"text-sm font-bold",children:a.count}),(0,b.jsx)("p",{className:"text-xs",children:ag(a.amount)})]},c))})]}),!1]})]}),X&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Export Data Analytics"}),(0,b.jsxs)("p",{className:"text-gray-600 mb-6",children:["Unduh laporan analitik untuk periode ",(0,b.jsx)("span",{className:"font-semibold",children:L[N]?.fullLabel})," dalam format CSV."]}),(0,b.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,b.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:"Data yang akan di-export:"}),(0,b.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,b.jsx)("li",{children:"âœ“ Ringkasan pendapatan & pesanan"}),(0,b.jsx)("li",{children:"âœ“ Breakdown metode pembayaran"}),(0,b.jsx)("li",{children:"âœ“ Item terlaris"}),(0,b.jsx)("li",{children:"âœ“ Performa meja"}),(0,b.jsx)("li",{children:"âœ“ Detail semua transaksi"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>Y(!1),className:"flex-1 px-4 py-2 border border-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Batal"}),(0,b.jsxs)("button",{onClick:()=>{let a=L[N],b=new Blob([[["Analytics Report"],["Restaurant",F?.name||""],["Period",a?.fullLabel||""],["Generated",new Date().toLocaleString("id-ID")],[""],["Summary"],["Total Revenue",P.revenue],["Total Orders",P.orders],["Average Order",P.avgOrder],[""],["Payment Methods"],["Cash",P.cashRevenue,`${P.revenue>0?(P.cashRevenue/P.revenue*100).toFixed(1):0}%`],["QRIS",P.qrisRevenue,`${P.revenue>0?(P.qrisRevenue/P.revenue*100).toFixed(1):0}%`],["Transfer",P.transferRevenue,`${P.revenue>0?(P.transferRevenue/P.revenue*100).toFixed(1):0}%`],[""],["Top Items"],["Rank","Item Name","Quantity Sold","Revenue"],...R.map((a,b)=>[b+1,a.name,a.count,a.revenue]),[""],["Table Performance"],["Rank","Table","Orders","Customers","Revenue","Avg Order"],...T.map((a,b)=>[b+1,`Meja ${a.tableNumber}`,a.orders,a.customers,a.revenue,a.avgOrder]),[""],["All Orders"],["Table","Total","Payment Method","Paid At","Items Count"],...V.map(a=>[a.tables?.number||"Takeaway",a.total||0,a.payment_method||"",a.paid_at?new Date(a.paid_at).toLocaleString("id-ID"):"",a.order_items?.length||0])].map(a=>a.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");c.href=URL.createObjectURL(b),c.download=`analytics-${F?.name}-${a?.fullLabel}.csv`,c.click(),Y(!1)},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[(0,b.jsx)(l,{className:"w-4 h-4"}),"Export CSV"]})]})]})})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-accent)]"})})}a.s(["default",()=>B],53832)}];

//# sourceMappingURL=src_app_dashboard_analytics_page_tsx_22a37508._.js.map